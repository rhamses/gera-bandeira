<!DOCTYPE html>
<html lang="pt-br">
<head>
	<meta charset="UTF-8">
	<title>Gera Bandeira</title>
	<meta property="og:title" content="Gere o seu próprio lema da Bandeira do Brasil">
	<meta property="og:site_name" content="Gera Bandeira">
	<meta property="og:url" content="https://gerabandeira.netlify.app/">
	<meta property="og:description" content="">
	<meta property="og:type" content="website">
	<meta property="og:image" content="https://gerabandeira.netlify.app/ordem-progresso.png">
	<meta name="twitter:card" content="summary_large_image" />
	<link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css">
	<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/bulma/0.8.2/css/bulma.min.css'>
	<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css'>
	<style>
		body {
			font-family: 'Roboto', sans-serif;
		}

		.input {
			text-transform: uppercase;
		}

		.field {
			-webkit-box-pack: center !important;
			justify-content: center !important;
		}

		.bandeira svg {
			max-width: 100%;
		}

		.hidden {
			visibility: hidden;
		}

		.hide {
			display: none;
		}
	</style>
</head>
<body translate="no">

<section class="hero is-primary">
    <div class="hero-body">
      <div class="container">
        <h1 class="title">
          Crie sua própria bandeira.
        </h1>
        <h2 class="subtitle">
          Digita o novo slogan da bandeira e baixe ou compartilhe a imagem
        </h2>
      </div>
    </div>
  </section>
  <section class="section">
    <div class="container">
      <div class="columns">
        <div class="column has-text-centered is-centered">
          <p class="subtitle is-4">Qual o lema da bandeira que você vai escolher?</p>
          <div class="notification is-success is-light hide">
            <p class="help">
              Ao gerar a imagem, ele ficará salvo no seu ctrl+c para ficar fácil colar por aí ;)
              <br>
              Mas se quiser, salve a imagem abaixo na sua biblioteca de imagens para compartilhar por aí.
            </p>
          </div>
          <div class="field has-addons">
            <div>
              <p class="control is-expanded has-icons-left has-icons-right">
                <input class="input" type="text" id="txtSlogan" placeholder="ORDEM E PROGRESSO">
                <span class="icon is-small is-left">
                  <i class="fas fa-flag"></i>
                </span>
              </p>
            <svg style="display: none;" xmlns="http://www.w3.org/2000/svg" width="700" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.0" viewBox="-2100 -1470 4200 2940">
              <style type="text/css" >
                <![CDATA[

                  text {
                    font-family: 'Roboto', sans-serif;
  fill: #009c3b;
  font-size: 6.5em;
  text-transform: uppercase;
  font-variant: petite-caps;
  font-weight: bold;
  letter-spacing: .05em;
}

                ]]>
              </style>
              <defs />
              <defs>
                <path id="i" fill-rule="evenodd" d="M-31.5 0h33a30 30 0 0030-30v-10a30 30 0 00-30-30h-33zm13-13h19a19 19 0 0019-19v-6a19 19 0 00-19-19h-19z" />
                <path id="j" d="M0 0h63v-13H12v-18h40v-12H12v-14h48v-13H0z" transform="translate(-31.5)" />
                <path id="l" d="M-26.25 0h52.5v-12h-40.5v-16h33v-12h-33v-11H25v-12h-51.25z" />
                <path id="k" d="M-31.5 0h12v-48l14 48h11l14-48V0h12v-70H14L0-22l-14-48h-17.5z" />
                <path id="b" fill-rule="evenodd" d="M0 0a31.5 35 0 000-70A31.5 35 0 000 0m0-13a18.5 22 0 000-44 18.5 22 0 000 44" />
                <path id="c" fill-rule="evenodd" d="M-31.5 0h13v-26h28a22 22 0 000-44h-40zm13-39h27a9 9 0 000-18h-27z" />
                <path id="n" d="M-15.75-22C-15.75-15-9-11.5 1-11.5s14.74-3.25 14.75-7.75c0-14.25-46.75-5.25-46.5-30.25C-30.5-71-6-70 3-70s26 4 25.75 21.25H13.5c0-7.5-7-10.25-15-10.25-7.75 0-13.25 1.25-13.25 8.5-.25 11.75 46.25 4 46.25 28.75C31.5-3.5 13.5 0 0 0c-11.5 0-31.55-4.5-31.5-22z" />
                <use id="o" transform="scale(31.5)" xlink:href="#f" />
                <use id="p" transform="scale(26.25)" xlink:href="#f" />
                <use id="r" transform="scale(21)" xlink:href="#f" />
                <use id="q" transform="scale(15)" xlink:href="#f" />
                <use id="s" transform="scale(10.5)" xlink:href="#f" />
                <g id="m">
                  <clipPath id="a">
                    <path d="M-31.5 0v-70h63V0zM0-47v12h31.5v-12z" />
                  </clipPath>
                  <use clip-path="url(#a)" xlink:href="#b" />
                  <path d="M5-35h26.5v10H5z" />
                  <path d="M21.5-35h10V0h-10z" />
                </g>
                <g id="h">
                  <use xlink:href="#c" />
                  <path d="M28 0c0-10 0-32-15-32H-6c22 0 22 22 22 32" />
                </g>
                <g id="f" fill="#fff">
                  <g id="e">
                    <path id="d" d="M0-1v1h.5" transform="rotate(18 0 -1)" />
                    <use transform="scale(-1 1)" xlink:href="#d" />
                  </g>
                  <use transform="rotate(72)" xlink:href="#e" />
                  <use transform="rotate(-72)" xlink:href="#e" />
                  <use transform="rotate(144)" xlink:href="#e" />
                  <use transform="rotate(216)" xlink:href="#e" />
                </g>
              </defs>
              <rect width="100%" height="100%" x="-50%" y="-50%" fill="#009b3a" />
              <path fill="#fedf00" d="M-1743 0L0 1113 1743 0 0-1113z" />
              <circle r="735" fill="#002776" />
              <clipPath id="g">
                <circle r="735" />
              </clipPath>
              <path fill="#fff" d="M-2205 1470a1785 1785 0 013570 0h-105a1680 1680 0 10-3360 0z" clip-path="url(#g)" />
              <use x="-600" y="-132" xlink:href="#o" />
              <use x="-535" y="177" xlink:href="#o" />
              <use x="-625" y="243" xlink:href="#p" />
              <use x="-463" y="132" xlink:href="#q" />
              <use x="-382" y="250" xlink:href="#p" />
              <use x="-404" y="323" xlink:href="#r" />
              <use x="228" y="-228" xlink:href="#o" />
              <use x="515" y="258" xlink:href="#o" />
              <use x="617" y="265" xlink:href="#r" />
              <use x="545" y="323" xlink:href="#p" />
              <use x="368" y="477" xlink:href="#p" />
              <use x="367" y="551" xlink:href="#r" />
              <use x="441" y="419" xlink:href="#r" />
              <use x="500" y="382" xlink:href="#p" />
              <use x="365" y="405" xlink:href="#r" />
              <use x="-280" y="30" xlink:href="#p" />
              <use x="200" y="-37" xlink:href="#r" />
              <use y="330" xlink:href="#o" />
              <use x="85" y="184" xlink:href="#p" />
              <use y="118" xlink:href="#p" />
              <use x="-74" y="184" xlink:href="#r" />
              <use x="-37" y="235" xlink:href="#q" />
              <use x="220" y="495" xlink:href="#p" />
              <use x="283" y="430" xlink:href="#r" />
              <use x="162" y="412" xlink:href="#r" />
              <use x="-295" y="390" xlink:href="#o" />
              <use y="575" xlink:href="#s" />
              <path id="textcurve" fill="none" stroke="none" stroke-width="5.8333" d="m -713.21966,-201.29945 c 562.307,-86.12035 1021.54857,75.76051 1412.11687,402.8864" />
              <text x="0">
                <textPath xlink:href="#textcurve" startOffset="50%" text-anchor="middle">
                  Ordem e Progresso
                </textPath>
              </text>
            </svg>
            </div>
          </div>
          <p class="aviso"></p>
          <div class="bandeira"></div>
        </div>
      </div>
    </div>
  </section>

	<script id="rendered-js">
    	//
// VARIABLES
//
const limitWidth = 236;
const limitX = 1400; // se refere a quanto o x do svg vai de um lado ao outro
const width = 700;
const height = 490;
//
//
//
const textContent = document.querySelector("text");
const txtSlogan = document.querySelector('#txtSlogan');
const textPath = document.querySelector("textPath");
const bandWidth = Math.round(document.querySelector("#textcurve").getBoundingClientRect().width);
const halfCanvas = bandWidth / 2;
const svg = document.querySelector("svg");

genImage();

txtSlogan.addEventListener('keyup', function(){
	if(this.value.length > 0 ) {
		document.querySelector('.notification').classList.remove('hide');
		textPath.textContent = "Ordem e Progresso";
	} else {
		document.querySelector('.notification').classList.add('hide');
	}
	textPath.textContent = this.value.normalize('NFD').replace(/[\u0300-\u036f]/g, "");
	genImage();
});

function genImage(){
  //
  // Get SVG and transform to base64
  //
  const svg = document.querySelector("svg");
  const xml = new XMLSerializer().serializeToString(svg);
  const svg64 = btoa(xml);
  const b64Start = 'data:image/svg+xml;base64,';
  //
  // Create Canvas
  //
  const canvas = document.createElement('canvas');
  canvas.width = width;
  canvas.height = height;
  const ctx = canvas.getContext('2d');
  //
  // Create Image
  //
  var img = document.createElement( "img" );
  img.setAttribute( "src", b64Start + svg64 );
  img.width = width;
  img.height = height;
  //
  // Created image on load
  //
  img.onload = function() {
  	ctx.drawImage( img, 0, 0, width, height);
    //
    // Create Image to show
    //
    const imgToShow = document.createElement('img');
    imgToShow.id="bandeiraImg";
    imgToShow.width = width;
    imgToShow.height = height;
    imgToShow.setAttribute( "src", canvas.toDataURL( "image/png" ) );
    //
    // Write files to the page
    //
    if(document.querySelector('.bandeira img')){
    	document.querySelector('.bandeira img').remove();
    }
    document.querySelector('.bandeira').append(imgToShow);
  };
}
</script>
</body>
</html>
